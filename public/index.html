<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Discord Rich Presence custom manager">
    <title>Discord RPC Manager</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css">
</head>

<body>
    <div class="app-layout">
        <header class="app-header">
            <div class="header-left">
                <div class="logo">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                        <path
                            d="M20.317 4.492c-1.53-.69-3.17-1.2-4.885-1.49a.075.075 0 00-.079.036c-.21.369-.444.85-.608 1.23a18.566 18.566 0 00-5.487 0 12.36 12.36 0 00-.617-1.23A.077.077 0 008.562 3c-1.714.29-3.354.8-4.885 1.491a.07.07 0 00-.032.027C.533 9.093-.32 13.555.099 17.961a.08.08 0 00.031.055 20.03 20.03 0 005.993 2.98.078.078 0 00.084-.026c.462-.62.874-1.275 1.226-1.963.021-.04.001-.088-.041-.104a13.201 13.201 0 01-1.872-.878.075.075 0 01-.008-.125c.126-.093.252-.19.372-.287a.075.075 0 01.078-.01c3.927 1.764 8.18 1.764 12.061 0a.075.075 0 01.079.009c.12.098.245.195.372.288a.075.075 0 01-.006.125c-.598.344-1.22.635-1.873.877a.075.075 0 00-.041.105c.36.687.772 1.341 1.225 1.962a.077.077 0 00.084.028 19.963 19.963 0 006.002-2.981.076.076 0 00.032-.054c.5-5.094-.838-9.52-3.549-13.442a.06.06 0 00-.031-.028zM8.02 15.278c-1.182 0-2.157-1.069-2.157-2.38 0-1.312.956-2.38 2.157-2.38 1.21 0 2.176 1.077 2.157 2.38 0 1.312-.956 2.38-2.157 2.38zm7.975 0c-1.183 0-2.157-1.069-2.157-2.38 0-1.312.955-2.38 2.157-2.38 1.21 0 2.176 1.077 2.157 2.38 0 1.312-.946 2.38-2.157 2.38z"
                            fill="#5865F2" />
                    </svg>
                    <span data-i18n="appTitle">RPC Manager</span>
                </div>
            </div>
            <div class="header-right" style="display:flex;align-items:center;gap:10px">
                <select id="language_select" onchange="setLanguage(this.value)"
                    style="background:var(--bg-elevated);border:1px solid var(--border);color:var(--text-primary);border-radius:6px;padding:5px 10px;font-size:12px;font-family:inherit;cursor:pointer;">
                    <option value="zh-TW">繁體中文</option>
                    <option value="en">English</option>
                    <option value="ja">日本語</option>
                </select>
                <div class="status-indicator">
                    <span class="status-dot" id="statusDot"></span>
                    <span id="statusText" data-i18n="statusLoading">LOADING...</span>
                </div>
            </div>
        </header>

        <div class="main-content">
            <aside class="preview-panel">
                <div class="panel-title" data-i18n="preview">即時預覽</div>
                <div class="discord-preview">
                    <div class="discord-header" data-i18n="playing">正在玩遊戲</div>
                    <div class="discord-activity">
                        <div class="activity-images">
                            <div class="activity-large-img-wrap">
                                <img class="activity-large-img" id="prevLargeImg" alt="">
                                <div class="activity-large-placeholder" id="largePlaceholder">
                                    <svg width="28" height="28" viewBox="0 0 24 24" fill="none">
                                        <rect x="3" y="3" width="18" height="18" rx="3" stroke="#4e5058"
                                            stroke-width="1.5" />
                                        <circle cx="8.5" cy="8.5" r="1.5" fill="#4e5058" />
                                        <path d="M21 15l-5-5L5 21" stroke="#4e5058" stroke-width="1.5"
                                            stroke-linecap="round" stroke-linejoin="round" />
                                    </svg>
                                </div>
                            </div>
                            <img class="activity-small-img" id="prevSmallImg" alt="" style="display:none">
                        </div>
                        <div class="activity-info">
                            <div class="activity-name" id="prevTitle">Unknown Game</div>
                            <div class="activity-details" id="prevDetails">Details</div>
                            <div class="activity-state" id="prevState">State</div>
                            <div class="activity-time" id="prevTime">
                                <svg width="12" height="12" viewBox="0 0 24 24" fill="none">
                                    <circle cx="12" cy="12" r="9" stroke="#6d6f78" stroke-width="2" />
                                    <path d="M12 7v5l3 3" stroke="#6d6f78" stroke-width="2" stroke-linecap="round" />
                                </svg>
                                <span id="prevTimeText">00:00 elapsed</span>
                            </div>
                        </div>
                    </div>
                    <div class="activity-buttons" id="prevButtons"></div>
                </div>

                <div class="quick-actions">
                    <button class="action-btn start-btn" onclick="startRPC()">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
                            <polygon points="5,3 19,12 5,21" />
                        </svg>
                        <span data-i18n="startRpc">啟動 RPC</span>
                    </button>
                    <button class="action-btn stop-btn" onclick="stopRPC()">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
                            <rect x="4" y="4" width="16" height="16" rx="2" />
                        </svg>
                        <span data-i18n="stopRpc">停止 RPC</span>
                    </button>
                </div>
            </aside>

            <main class="settings-panel">
                <section class="settings-section">
                    <div class="section-header">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                            <path d="M12 15a3 3 0 100-6 3 3 0 000 6z" stroke="#b5bac1" stroke-width="2" />
                            <path
                                d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 11-2.83 2.83l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 11-4 0v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 11-2.83-2.83l.06-.06A1.65 1.65 0 004.68 15a1.65 1.65 0 00-1.51-1H3a2 2 0 110-4h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 112.83-2.83l.06.06A1.65 1.65 0 009 4.68a1.65 1.65 0 001-1.51V3a2 2 0 114 0v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 112.83 2.83l-.06.06A1.65 1.65 0 0019.4 9a1.65 1.65 0 001.51 1H21a2 2 0 110 4h-.09a1.65 1.65 0 00-1.51 1z"
                                stroke="#b5bac1" stroke-width="2" />
                        </svg>
                        <h2 data-i18n="sectionConnection">連線設定</h2>
                    </div>
                    <div class="form-group">
                        <label data-i18n="labelToken">User Token</label>
                        <div class="input-with-icon">
                            <input type="password" id="token" data-i18n-placeholder="placeholderToken"
                                placeholder="輸入您的 Discord Token">
                            <button class="input-icon-btn" onclick="toggleTokenVisibility()" type="button">
                                <svg id="eyeIcon" width="16" height="16" viewBox="0 0 24 24" fill="none">
                                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" stroke="currentColor"
                                        stroke-width="2" />
                                    <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2" />
                                </svg>
                            </button>
                        </div>
                        <div class="help-text" data-i18n="helpToken">請勿將 Token 洩漏給他人</div>
                    </div>
                    <div class="form-group">
                        <label data-i18n="labelAppId">Application ID</label>
                        <input type="text" id="application_id" data-i18n-placeholder="placeholderAppId"
                            placeholder="您的 Discord 應用程式 ID">
                        <div class="help-text"><span data-i18n="helpAppId">在 Discord Developer Portal 取得</span> — <a
                                href="https://discord.com/developers/applications" target="_blank"
                                rel="noopener">portal</a></div>
                    </div>
                </section>

                <section class="settings-section">
                    <div class="section-header">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                            <path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7" stroke="#b5bac1"
                                stroke-width="2" stroke-linecap="round" />
                            <path d="M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z" stroke="#b5bac1"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                        </svg>
                        <h2 data-i18n="sectionContent">顯示內容</h2>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label data-i18n="labelDetails">Details (第一行)</label>
                            <input type="text" id="details" data-i18n-placeholder="placeholderDetails"
                                placeholder="例如: 鑽石託管">
                        </div>
                        <div class="form-group">
                            <label data-i18n="labelState">State (第二行)</label>
                            <input type="text" id="state" data-i18n-placeholder="placeholderState"
                                placeholder="例如: 高效能伺服器託管">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label data-i18n="labelTimestamp">時間顯示模式</label>
                            <select id="timestamp_mode" onchange="toggleCustomTime()">
                                <option value="none" data-i18n="tsNone">不顯示</option>
                                <option value="elapsed" data-i18n="tsElapsed">經過時間</option>
                                <option value="local" data-i18n="tsLocal">當地時間</option>
                                <option value="custom" data-i18n="tsCustom">自訂時間</option>
                            </select>
                        </div>
                        <div class="form-group" id="customTimeGroup" style="display:none">
                            <label data-i18n="labelCustomTime">自訂時間</label>
                            <input type="datetime-local" id="custom_timestamp">
                        </div>
                    </div>
                </section>

                <section class="settings-section">
                    <div class="section-header">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                            <rect x="3" y="3" width="18" height="18" rx="3" stroke="#b5bac1" stroke-width="2" />
                            <circle cx="8.5" cy="8.5" r="1.5" fill="#b5bac1" />
                            <path d="M21 15l-5-5L5 21" stroke="#b5bac1" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round" />
                        </svg>
                        <h2 data-i18n="sectionAssets">圖片資產</h2>
                    </div>
                    <div class="assets-control">
                        <textarea id="assets_list" rows="2" data-i18n-placeholder="placeholderAssets"
                            placeholder="點擊「自動讀取」或手動輸入 JSON 格式"></textarea>
                        <button class="btn-fetch" onclick="fetchAssets()" type="button">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none">
                                <path d="M1 4v6h6" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"
                                    stroke-linejoin="round" />
                                <path d="M3.51 15a9 9 0 105.64-9.36L1 10" stroke="currentColor" stroke-width="2.5"
                                    stroke-linecap="round" stroke-linejoin="round" />
                            </svg>
                            <span data-i18n="btnFetch">自動讀取</span>
                        </button>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label data-i18n="labelLargeImg">大圖片</label>
                            <select id="large_image_id">
                                <option value="">(無)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label data-i18n="labelLargeText">大圖片文字</label>
                            <input type="text" id="large_image_text">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label data-i18n="labelSmallImg">小圖片</label>
                            <select id="small_image_id">
                                <option value="">(無)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label data-i18n="labelSmallText">小圖片文字</label>
                            <input type="text" id="small_image_text">
                        </div>
                    </div>
                </section>

                <section class="settings-section">
                    <div class="section-header">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                            <rect x="3" y="3" width="18" height="13" rx="2" stroke="#b5bac1" stroke-width="2" />
                            <path d="M7 21h10M12 16v5" stroke="#b5bac1" stroke-width="2" stroke-linecap="round" />
                        </svg>
                        <h2 data-i18n="sectionButtons">按鈕連結</h2>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label data-i18n="labelBtn1Text">按鈕 1 文字</label>
                            <input type="text" id="btn1_label">
                        </div>
                        <div class="form-group">
                            <label data-i18n="labelBtn1Url">按鈕 1 連結</label>
                            <input type="url" id="btn1_url" placeholder="https://">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label data-i18n="labelBtn2Text">按鈕 2 文字</label>
                            <input type="text" id="btn2_label">
                        </div>
                        <div class="form-group">
                            <label data-i18n="labelBtn2Url">按鈕 2 連結</label>
                            <input type="url" id="btn2_url" placeholder="https://">
                        </div>
                    </div>
                </section>

                <div class="form-actions">
                    <button class="btn-save" onclick="saveSettings()" type="button">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                            <path d="M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z" stroke="currentColor"
                                stroke-width="2" />
                            <polyline points="17,21 17,13 7,13 7,21" stroke="currentColor" stroke-width="2" />
                            <polyline points="7,3 7,8 15,8" stroke="currentColor" stroke-width="2" />
                        </svg>
                        <span data-i18n="btnSave">儲存設定</span>
                    </button>
                </div>
            </main>
        </div>
    </div>

    <div class="toast-container" id="toastContainer"></div>

    <script src="/js/i18n.js"></script>
    <script src="/js/main.js"></script>
</body>

</html>